# pytorch-inpainting-with-partial-conv

This is an unofficial pytorch implementation of a paper, Image Inpainting for Irregular Holes Using Partial Convolutions' [Liu+, arXiv2018].

## Requirements
```
pip install -r requirements.txt
```

## Usage

### Preprocess
Prepare data directory (default: `./data`) containing the following :
- `masks`: masks generated by following [2]
- `images`: images used for training
- `train.txt`, `val.txt`: list name of files in `images`

And then, use this command.
```
python generate_data.py
```

### Train
Use `--content_dir` and `--style_dir` to provide the respective directory to the content and style images.
```
CUDA_VISIBLE_DEVICES=$(nvidia-empty) python train.py
```

## References
- [1]: G. Liu et al. "Image Inpainting for Irregular Holes Using Partial Convolutions", in arXiv, 2018.
- [2]: [Unofficial implementation in Chainer](https://github.com/SeitaroShinagawa/chainer-partial_convolution_image_inpainting)
